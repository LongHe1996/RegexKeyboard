<!DOCTYPE html>
<!--[if lt IE 7 ]>
<html class="ie6"> <![endif]-->
<!--[if IE 7 ]>
<html class="ie7"> <![endif]-->
<!--[if IE 8 ]>
<html class="ie8"> <![endif]-->
<!--[if IE 9 ]>
<html class="ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!-->
<html xmlns:th="http://www.w3.org/1999/xhtml" lang="en"><!--<![endif]-->
<head>
    <meta charset="utf-8"/>

    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <meta name="description" content=""/>
    <meta name="author" content=""/>

    <title>SingleQuestion - Regex Keyboard</title>

    <!-- Standard Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/images//favicon.ico"/>

    <!-- For iPhone 4 Retina display: -->
    <link rel="apple-touch-icon-precomposed" href="assets/images//apple-touch-icon-114x114-precomposed.png"/>

    <!-- For iPad: -->
    <link rel="apple-touch-icon-precomposed" href="assets/images//apple-touch-icon-72x72-precomposed.png"/>

    <!-- For iPhone: -->
    <link rel="apple-touch-icon-precomposed" href="assets/images//apple-touch-icon-57x57-precomposed.png"/>

    <!-- Library - Google Font Familys -->
    <link href="https://fonts.googleapis.com/css?family=Poppins:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i%7cRaleway:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i%7cRoboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i%7cYanone+Kaffeesatz:200,300,400,700"
          rel="stylesheet"/>

    <link rel="stylesheet" type="text/css" href="assets/revolution/css/settings.css"/>
    <!-- Library -->
    <link href="assets/css/lib.css" rel="stylesheet"/>

    <!-- Custom - Common CSS -->
    <link rel="stylesheet" href="assets/css/rtl.css"/>
    <link rel="stylesheet" type="text/css" href="style.css"/>

    <!--[if lt IE 9]>
    <script src="js/html5/respond.min.js"></script>
    <![endif]-->

</head>

<body data-offset="200" data-spy="scroll" data-target=".ownavigation">
<!-- Loader -->
<div id="site-loader" class="load-complete">
    <div class="loader">
        <div class="line-scale">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
</div><!-- Loader /- -->

<div class="main-container">

    <main class="site-main">

        <div class="container-block">
            <div class="row no-gutters">
                <!-- Menu Sidebar -->
                <div class="menu-sidebar col-lg-4">
                    <!-- Header Section -->
                    <div class="header_s">
                        <!-- SidePanel -->
                        <div id="slidepanel-1" class="slidepanel">
                            <!-- Top Header -->
                            <div class="top-header">
                                <!-- Container -->
                                <div class="container no-padding">
                                    <div class="top-content logindiv">
											<span class="loginname" style="width: 250px"><i
                                                    class='fa fa-user-circle'></i></span>
                                    </div>
                                </div><!-- Container /- -->
                            </div><!-- Top Header /- -->
                        </div><!-- SidePanel /- -->
                        <!-- Menu Block -->
                        <div class="menu-block">
                            <nav class="navbar ownavigation navbar-expand-lg">
                                <!-- Container -->
                                <div class="container">
                                    <!--a class="navbar-brand text-logo" href="index.html">Airco <span>air conditioning</span></a-->
                                    <a class="image-logo navbar-brand" href="home.html"><img
                                            src="assets/images/logo.png" alt="Logo"/></a>
                                    <button class="navbar-toggler navbar-toggler-right" type="button"
                                            data-toggle="collapse" data-target="#navbar" aria-controls="navbar"
                                            aria-expanded="true" aria-label="Toggle navigation">
                                        <i class="fa fa-bars"></i>
                                    </button>
                                    <div class="collapse navbar-collapse" id="navbar">
                                        <ul class="navbar-nav">
                                            <li><a class="nav-link" title="Home" href="home.html">Home</a></li>
                                            <li><a class="nav-link" title="ReadMe" href="readme.html">ReadMe</a></li>
                                            <li><a class="nav-link" title="LearnMore"
                                                   href="learnmore.html">LearnMore</a></li>
                                            <li><a class="nav-link" title="KeyBoard" href="keyboard.html">KeyBoard</a>
                                            </li>
                                            <li><a class="nav-link" title="Test" href="test.html">Test</a></li>
                                            <li class="dropdown active">
                                                <a href="qanda.html" class="nav-link dropdown-toggle" title="QaA"
                                                   role="button" aria-haspopup="true" aria-expanded="false">Q&amp;A</a>
                                                <i class="ddl-switch fa fa-angle-down"></i>
                                                <ul class="dropdown-menu">
                                                    <li><a class="dropdown-item  myquestionlogin"></a></li>
                                                    <li><a class="dropdown-item myanswerlogin"></a></li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </div>
                                    <div id="loginpanel-1" class="desktop-hide">
                                        <div class="right toggle" id="toggle-1">
                                            <a id="slideit-1" class="slideit" href="#slidepanel"><i
                                                    class="fo-icons fa fa-inbox"></i></a>
                                            <a id="closeit-1" class="closeit" href="#slidepanel"><i
                                                    class="fo-icons fa fa-times"></i></a>
                                        </div>
                                    </div>
                                </div><!-- Container /- -->
                            </nav>
                        </div><!-- Menu Block /- -->
                    </div><!-- Header Section /- -->
                </div><!-- Menu Sidebar /- -->
                <!-- Content Area Block -->
                <div class="content-area-block col-lg-8">

                    <!-- Page Banner -->
                    <div class="page-banner">
                        <!-- Container -->
                        <div class="container">
                            <h3>Single Question</h3>
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a href="home.html">Home</a></li>
                                <li class="breadcrumb-item active">Single Question</li>
                            </ol>
                        </div><!-- Container /- -->
                    </div><!-- Page Banner /- -->

                    <!-- Container -->
                    <div class="container">
                        <!-- Blog Listing -->
                        <div class="blog-single">
                            <!-- Row -->
                            <div class="row">
                                <!-- Content Area -->
                                <div class="col-md-8 content-area">
                                    <div class="blog-box">
                                        <div class="post-content">
                                            <h3 class="post-title" th:text="${questionTitle}"></h3>
                                            <p th:text="${questionContent}"></p>
                                            <div class="post-meta">
                                                <span class="post-date"><a th:text="${questionerNickName}"></a><label class="questioner" th:text="${questionerId}" style="color: #ffffff"></label></span>
                                                <span class="post-date"><a
                                                        th:text="${questionPutTime}"></a></span>
                                                <span class="post-comments"><a
                                                        th:text="${answerNum}"></a></span>
                                                <button class="btncol" onclick="putIntoCol()">收藏</button>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Comment Area -->
                                    <div class="comments-area">
                                        <!-- Comment Form -->
                                        <div class="comment-respond">
                                            <h2 class="comment-reply-title">Leave an Answer:</h2>
                                            <form method="post" class="comment-form" action="/submitanswer">
                                                <input type="hidden" name="loginUserName" value=""
                                                       class="hiddenInput"/>
                                                <input type="hidden" name="questionId" value=""
                                                       class="hiddenQuestionId"/>
                                                <p class="comment-form-comment">
                                                    <textarea placeholder="Comment" rows="6"
                                                              required="required" name="answerContent"></textarea>
                                                </p>
                                                <p class="form-submit">
                                                    <input name="submit" class="submit" value="Submit" type="submit"/>
                                                </p>
                                            </form>
                                            <div class="allanswerbox">

                                            </div>
                                            <div class="row single-gallery" style="margin-top: 50px">
                                                <div class="col-3">
                                                    <a href="assets/images/sinlge-gallery-1.jpg"><img
                                                            src="assets/images/sinlge-gallery-1.jpg" alt="Gallery"/></a>
                                                </div>
                                                <div class="col-3">
                                                    <a href="assets/images/sinlge-gallery-1.jpg"><img
                                                            src="assets/images/sinlge-gallery-2.jpg" alt="Gallery"/></a>
                                                </div>
                                                <div class="col-3">
                                                    <a href="assets/images/sinlge-gallery-1.jpg"><img
                                                            src="assets/images/sinlge-gallery-3.jpg" alt="Gallery"/></a>
                                                </div>
                                                <div class="col-3">
                                                    <a href="assets/images/sinlge-gallery-1.jpg"><img
                                                            src="assets/images/sinlge-gallery-4.jpg" alt="Gallery"/></a>
                                                </div>
                                            </div>
                                        </div><!-- Comment Form /- -->
                                    </div><!-- Comment Area /- -->
                                </div><!-- Content Area /- -->
                                <div class="col-md-4 widget-area">
                                    <!-- Widget: Categories -->
                                    <aside id="categories" class="widget widget_categories">
                                        <h3 class="widget-title">Latest questions</h3>
                                        <ul class="latestquestionbox">
                                        </ul>
                                    </aside><!-- Widget: Categories /- -->

                                </div>
                            </div><!-- Row /- -->
                        </div><!-- Blog Listing /- -->
                    </div><!-- Container /- -->

                    <!-- Footer Section -->
                    <div class="footer-section">
                        <div class="bottom-footer">
                            <!-- Container -->
                            <div class="container">
                                <div class="ftr-content">
                                    <p><i class="fa fa-copyright"></i>&nbsp;Regex Keyboard 2018. All Rights Reserved&nbsp;&nbsp;
                                        &nbsp;&nbsp;<a style="color: #ffffff" href="https://eugenhahaha.me"><i
                                                class="fab fa-grav"></i>&nbsp;Eugen&nbsp;&nbsp;</a>
                                        &nbsp;&nbsp;<a style="color: #ffffff"
                                                       href="mailto:longhe1996@foxmail.com"><i
                                                class="fa fa-envelope"></i>&nbsp;email&nbsp;&nbsp;</a>
                                        &nbsp;&nbsp;<a style="color: #ffffff"
                                                       href="https://github.com/LongHe1996/RegexKeyboard"><i
                                                class="fab fa-github"></i>&nbsp;github&nbsp;&nbsp;</a>
                                    </p>
                                </div>
                            </div><!-- Container /- -->
                        </div>
                    </div><!-- Footer Section /- -->

                </div><!-- Content Area Block /- -->
            </div>
        </div>

    </main>

</div>

<!-- JQuery v1.12.4 -->
<script src="assets/js/jquery-1.12.4.min.js"></script>
<script src="js/jquery.min.js"></script>
<script src="js/jquery.cookie.js"></script>
<!-- Library - Js -->
<script src="assets/js/popper.min.js"></script>
<script src="assets/js/lib.js"></script>

<!-- Library - Theme JS -->
<script id="function" src="assets/js/functions.js"></script>
<script>
    $(document).ready(function () {
        var name = $.cookie("LoginUserName");
        var url1 = "\"profile.html\"";
        var url2 = "\"\\\"";
        var font = "\"fa fa-heart\"";
        var url3 = "\"collection.html\"";
        if (name != null) {
            $(".submit").attr("disabled",false);
            $(".loginname").append("<a href=" + url1 + ">" + name + "</a>");
            $(".logindiv").append("<span><i class=" + font + "></i><a href=" + url3 + ">collection</a></span>")
            $(".hiddenInput").val(name);
            $(".hiddenQuestionId").val(window.location.search.substr(4));
            //Menu box
            $(".myquestionlogin").attr("href", "/myquestion");
            $(".myquestionlogin").text("My Question");
            $(".myanswerlogin").attr("href", "/myanswer");
            $(".myanswerlogin").text("My Answer");

            $.ajax({
                type: "get",
                url: "someonesCollection?userId=" + $.cookie("LoginUserId"),
                dataType: "json",
                success: function (data) {
                    if (data["error"] == "0") {
                        $(".colTitlebox").append(data["error"]);
                        var flag = false;
                        $.each(data["collection"], function (i, col) {
                            if (col.id == window.location.search.substr(4)) {
                                flag = true;
                            }
                        });
                        if (flag) {
                            $(".btncol").text("取消收藏");
                        } else {
                            $(".btncol").text("收藏");
                        }
                    }
                },
                error: function () {
                    alert("失败，请稍后再试！");
                }
            })
        } else {
            $(".submit").attr("disabled",true);
            $(".submit").val("尚未登录哦");
            $(".loginname").append("<a href=" + url2 + ">尚未登录</a>");
            //Menu box
            $(".myquestionlogin").text("My Queztion- No Login");
            $(".myquestionlogin").attr("href", "/");
            $(".myanswerlogin").text("My Answer - No Login");
            $(".myanswerlogin").attr("href", "/");
        }
    })

    function putIntoCol() {
        if ($.cookie("LoginUserName") != null) {
            $.ajax({
                type: "get",
                url: "colop?uqstr=" + $.cookie("LoginUserId") + "a" + window.location.search.substr(4),
                dataType: "json",
                success: function (data) {
                    if (data["msg"] == "已收藏") {
                        $(".btncol").text("取消收藏");
                        $(".btncol").attr("onclick", "putIntoCol()");
                    } else {
                        $(".btncol").text("收藏");
                        $(".btncol").attr("onclick", "putIntoCol()");
                    }
                },
                error: function () {
                    alert("失败，请稍后再试！");
                }
            })
        } else {
            alert("尚未登录哦");
        }
    }


    $.ajax({
        type: "GET",
        url: "allAnswerToAQuestion?id=" + window.location.search.substr(4),
        dataType: "json",
        success: function (data) {
            if (data) {
                var answerbox = "\"answerbox\"";
                var acceptbtn = "\"acceptbtn\"";
                var acceptbox = "\"acceptbox\""
                var acceptbtnhidden = "\"visibility: hidden;margin-right: 10px\"";
                var brush = "\"fa fa-paint-brush\"";
                var check = "\"fa fa-check\"";
                var truestr = "\"true\"";
                var brushcolor = "\"color: #1e38ae\"";
                var checkcolor = "\"color:green;\"";
                var accepthint = "\"accepthint\"";
                var ifsolved = false;
                $.each(data["allAnswers"], function (i, item) {
                    var str = "<div class=" + answerbox + ">"
                        + "<label>" + item.nickName + "</label><label>" + item.putTime + "</label>"
                        + "<button class=" + acceptbtn + ">";
                    if (item.accepted) {
                        ifsolved=true;
                        str = str + "<label class=" + accepthint + " style=" + acceptbtnhidden + ">已被采纳</label>"
                            + "<i class = " + check + " aria-hidden= " + truestr + " style = " + checkcolor + "></i>";
                    } else if(!ifsolved){
                        str = str + "<label data-answerid="+item.id+" class=" + acceptbox + " style=" + acceptbtnhidden + ">采纳?</label>"
                            + "<i class= " + brush + " aria-hidden= " + truestr + " style = " + brushcolor + "></i>";
                    }else if(ifsolved){
                        str = str + "<label class=" + accepthint + " style=" + acceptbtnhidden + ">已有采纳！</label>"
                            + "<i class= " + brush +accepthint+" aria-hidden= " + truestr + " style = " + brushcolor + "></i>";
                    }
                    str = str + "</button><p>" + item.answerContent + "</p></div>";
                    $(".allanswerbox").append(str);
                })
            }
        }
    });

    $.ajax({
        type: "GET",
        url: "getAllQuestions",
        dataType: "json",
        success: function (data) {
            if (data) {
                var catitem = "\"cat-item\"";
                $.each(data["allQuestion"], function (i, item) {
                    var singlequestion = "\"getsinglequestion?id=" + item.id + "\"";
                    var str = "<li class=" + catitem + "><a href=" + singlequestion + ">" + item.questionTitle.substr(0, 8) + "…</a>(" + item.answerNum + ")</li>";
                    $(".latestquestionbox").append(str);
                })
            }
        }
    });
    $("body").on("mouseover", ".acceptbtn",function () {
        $(this).children(".acceptbox").css("visibility","");
    } );
    $("body").on("mouseout", ".acceptbtn",function () {
        $(this).children(".acceptbox").css("visibility","hidden");
    } );
    $("body").on("mouseover", ".acceptbtn",function () {
        $(this).children(".accepthint").css("visibility","");
    } );
    $("body").on("mouseout", ".acceptbtn",function () {
        $(this).children(".accepthint").css("visibility","hidden");
    } );
    $("body").on("click", ".acceptbox",function () {
        var answerId=$(this).data("answerid");
        alert(answerId);
        var questioner = $(".questioner").text();
        var loginuser = $.cookie("LoginUserId");
        if(loginuser==null){
            alert("没有登录哦！");
        }else if(questioner==loginuser){
            window.location.href="doaccept?qanda="+window.location.search.substr(4)+"answer"+answerId;
        }else{
            alert('你不是提问人，不能进行采纳哦！');
        }

    } );
</script>

</body>
</html>